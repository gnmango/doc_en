Let's make it so that when the Meso or item data changes, the inventory UI changes as well. In this course, we will only modify the UIInventory component.

# Reflecting Changed Inventory Value in UI
Let's make the UI refresh when the inventory meso or item value changes.
The UIInventory component is a component that is automatically added when an inventory preset is added. 

><span style="color: #7cafc2">**Tip**
>Let's **delete all of the existing Event Handlers** of this component and then follow the steps below to create a new one.</span>

1. Maintain the existing properties and add new **MesoUI, SlotList** properties.

    ```lua
    Property:
    [None]
    Entity MesoUI = nil
    [None]
    table SlotList = {}
    ```

2. Delete the contents of the OnBeginPlay() function and change as follows. 

    ```lua
    Method:
    [client only]
    void OnBeginPlay()
    {
        self.itemUI =_EntityService:GetEntityByPath(self.Entity.Path .. "/InventoryPanel/Inventory_ScrollView/item_slot")
        self.itemUI:SetEnable(false)
        self.scrollView = _EntityService:GetEntityByPath(self.Entity.Path .. "/InventoryPanel/Inventory_ScrollView")
        self.MesoUI = _EntityService:GetEntityByPath(self.Entity.Path .. "/InventoryPanel/CoinPanel/coin_count")
        
        -- add UI Preset/Buttons
        local inventoryButton = _EntityService:GetEntityByPath(self.inventoryBtnPath)
        if inventoryButton ~= nil then
        	local openFunc = function()
        		self.Entity.Enable = true
        	end
        	if inventoryButton.ButtonComponent == nil then
        		inventoryButton:AddComponent("MOD.Core.ButtonComponent")
        	end
        	inventoryButton:ConnectEvent(ButtonClickEvent, openFunc)
        end
        
        -- Close Button
        local closeButton = _EntityService:GetEntityByPath(self.Entity.Path .. "/InventoryPanel/CloseButton")
        local closeFunc = function()
        	self.Entity.Enable = false
        end
        
        closeButton:ConnectEvent(ButtonClickEvent, closeFunc)
        
        -- Create as many item slots as inventory capacity in advance
        local capacity = _UserService.LocalPlayer.SimpleInventory.Capacity
        for i = 1, capacity do
        	local itemSlot = _SpawnService:SpawnByEntity(self.itemUI, "Slot", Vector3.zero, self.scrollView)
        	itemSlot.UIInventoryItemSlot:Clear()
        	
        	self.SlotList[i] = itemSlot
        end
    }
    ```
    
5. Add the new SetSlot() function. Add new **slotIndex, itemId, itemCount** parameters.
Set the item and its number to display in the slot corresponding to slotIndex.
    ```lua
    [client only]
    void SetSlot (integer slotIndex, string itemId, integer itemCount)
    {
        local slot = self.SlotList[slotIndex]
        slot.UIInventoryItemSlot:SetData(slotIndex, itemId, itemCount)
    }
    ```

6. Add the new ClearSlot() function and write the following to empty the contents of the slot corresponding to slotIndex.

    ```lua
    void ClearSlot (integer slotIndex)
    {
        local slot = self.SlotList[slotIndex]
        slot.UIInventoryItemSlot:Clear()
    }
    ```

7. Add the new SetMeso() function and write the following to display the Meso value in the Meso UI.

    ```lua
    [client only]
    void SetMeso (integer meso)
    {
        self.MesoUI.TextComponent.Text = tostring(meso)
    }
    ```

#### Adding Entity Event Handler

1. Add the SimpleInventoryInitializedEvent. Change the event relayer to the localPlayer.

    ```lua
    [localplayer]
    HandleSimpleInventoryInitializedEvent (SimpleInventoryInitializedEvent event)
    {
        -- Parameters
        local Meso = event.Meso
        local ItemStacks = event.ItemStacks
        ---------------------------------------------------------
    
        self:SetMeso(Meso)
        
        for _, stack in pairs(ItemStacks) do
        	if stack ~= nil then
        		self:SetSlot(stack.SlotIndex, stack.ItemId, stack.Count)
        	end
        end    
    }
    ```

2. Add the SimpleInventoryItemAddedEvent. Change the event relayer to the localPlayer.

    ```lua
    [localplayer]
    HandleSimpleInventoryItemAddedEvent (SimpleInventoryItemAddedEvent event)
    {
        -- Parameters
        local SlotIndex = event.SlotIndex
        local ItemId = event.ItemId
        local ItemCount = event.ItemCount
        ---------------------------------------------------------
    
        self:SetSlot(SlotIndex, ItemId, ItemCount)
    }
    ```


3. Add the SimpleInventoryItemModifiedEvent. Change the event relayer to the localPlayer.

    ```lua
    [localplayer]
    HandleSimpleInventoryItemModifiedEvent (SimpleInventoryItemModifiedEvent event)
    {
        -- Parameters
        local SlotIndex = event.SlotIndex
        local ItemId = event.ItemId
        local ItemCount = event.ItemCount
        ---------------------------------------------------------
    
        if ItemCount > 0 then
        	self:SetSlot(SlotIndex, ItemId, ItemCount)
        else
        	self:ClearSlot(SlotIndex)
        end
    }
    ```

4. Add the SimpleInventoryMesoModifiedEvent. Change the event relayer to the localPlayer.

    ```lua
    [localplayer]
    HandleSimpleInventoryMesoModifiedEvent (SimpleInventoryMesoModifiedEvent event)
    {
        -- Parameters
        local Meso = event.Meso
        ---------------------------------------------------------
    
        self:SetMeso(Meso)
    }
    ```

5. Add the SimpleInventoryItemRemovedEvent. Change the event relayer to the localPlayer.

    ```lua
    [localplayer]
    HandleSimpleInventoryItemRemovedEvent (SimpleInventoryItemRemovedEvent event)
    {
        -- Parameters
        local SlotIndex = event.SlotIndex
        local ItemId = event.ItemId
        ---------------------------------------------------------
    
        self:ClearSlot(SlotIndex)
    }
    ```